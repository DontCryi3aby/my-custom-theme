<div class="wrap">
    {% for block in section.blocks %}
        {% case block.type %}
            {% when 'image' %}
            <div class="image" {{ block.shopify_attributes }}>
                {{ block.settings.image | image_url: height: 200 | image_tag }}
    
                <h4 class="text">{{  block.settings.text }}</h4>
            </div>
        {% endcase %}
    {% endfor %}
</div>

{% assign blocksLength = section.blocks | size | divided_by: 3.0 | ceil  %}
{% render 'custom_list_dots', length: blocksLength  %}



<style>
    .image-with-text {
        width: 1200px;
        margin: 0 auto;
        overflow: hidden;
        position: relative;
    }

    .wrap {
        display: flex;
        margin-left: -10px;
        margin-right: -10px;
        position: relative;
        transition: all 0.2s linear;
    }

    .image {
        flex: 1 0 33.33333%;
        height: 280px;
        padding: 0 10px;
        position: relative;
    }

    .image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-weight: bold;
        font-size: 20px;
        color: #fff;
    }
</style>

<script>
    const dots = document.querySelectorAll(".dot")
    const listImageWrap = document.querySelector(".wrap")
    const listImage = document.querySelectorAll(".image")

    const imageWidth = listImage[0].offsetWidth
    const listImageWrapWidth = imageWidth * listImage.length

    dots.forEach((dot, index) => {
        dot.onclick = (e) => {

            // toggle active dot
            document.querySelector(".dot.active").classList.remove("active")
            e.target.classList.add("active")

            if(index !== dots.length-1) {
                listImageWrap.style.right = `${imageWidth * index * 3}px`
            } else {
                listImageWrap.style.right = `${listImageWrapWidth - imageWidth * 3}px`
            }
        } 
    })
</script>

{% schema %}
{
    "name": "Image-With-Text",
    "tag": "section",
    "class": "image-with-text",
    "blocks": [
       {
         "name": "Image",
         "type": "image",
         "settings": [
           {
                "type": "image_picker",
                "id": "image",
                "label": "Add image"
           },
           {
                "type": "text",
                "id": "text",
                "label": "Add text"
            }
         ]
       }
     ]
  }
{% endschema %}